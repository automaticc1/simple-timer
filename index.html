<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Task Timer & Stopwatch</n  
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet">
  <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>⏳</text></svg>">
  <style>
    :root { --gap: 1rem; --font: 'Inter', sans-serif; --bg: #f0f4f8; --fg: #222; --accent: #007bff; }
    * { box-sizing: border-box; }
    body { margin:0; height:100vh; font-family:var(--font); display:flex; background:linear-gradient(180deg,#f4f9ff 0%,#fdfdfd 100%); }
    .pane { padding:var(--gap); overflow-y:auto; }
    #tasks { width:35%; background:#fff; border-right:1px solid #ddd; }
    #timer-pane { flex:1; display:flex; flex-direction:column; }
    h2 { margin-top:0; }
    #summary { font-weight:bold; margin-bottom:var(--gap); }
    #schedule { display:flex; align-items:center; gap:0.5rem; margin-bottom:var(--gap); }
    #finish-time { margin-left:var(--gap); font-weight:600; }
    form { display:flex; gap:0.5rem; margin-bottom:1rem; }
    form input { flex:1; padding:0.5em; border:1px solid #ccc; border-radius:4px; }
    form button { padding:0.5em 1em; border:none; background:var(--accent); color:#fff; border-radius:4px; cursor:pointer; }
    ul { list-style:none; padding:0; margin:0; }
    li { display:flex; align-items:center; gap:0.5rem; padding:0.5em; margin-bottom:0.25em; background:var(--bg); border-radius:8px; cursor:grab; }
    li.dragging { opacity:0.5; }
    .task-name { flex:2; }
    .task-est { width:60px; text-align:right; }
    .btn { border:none; background:none; padding:0.2em; cursor:pointer; font-size:1em; }
    .btn.edit, .btn.delete { color:#666; opacity:0.6; }
    .btn.edit:hover, .btn.delete:hover { opacity:1; }
    .btn.start { background:#28a745; color:#fff; border-radius:4px; padding:0.3em 0.6em; font-size:1em; }
    .btn.start:hover { opacity:0.9; }
    .btn-group { margin-left:auto; display:flex; gap:0.5em; }
    .mode-toggle { display:flex; gap:0.5rem; margin-bottom:var(--gap); }
    .mode-btn { flex:1; padding:0.5em; border:none; cursor:pointer; background:#e0e0e0; border-radius:4px; }
    .mode-btn.active { background:var(--accent); color:#fff; }
    .main { flex:1; display:flex; justify-content:center; align-items:center; }
    .timer-display { font-size:6rem; font-weight:600; color:var(--fg); text-align:center; }
    .controls { padding:var(--gap); display:flex; flex-direction:column; align-items:center; gap:1rem; }
    .neumorphic-input { display:flex; align-items:center; background:var(--bg); border-radius:16px; box-shadow:inset 2px 2px 5px rgba(0,0,0,0.03), inset -2px -2px 5px rgba(255,255,255,0.8); padding:0.8rem 1.2rem; width:220px; }
    .neumorphic-input input { border:none; background:transparent; font-size:1.2rem; width:100%; text-align:center; outline:none; color:#333; }
    .button-row { display:flex; gap:1rem; margin-top:0.5rem; }
    .icon-btn { background:var(--bg); border:none; padding:0.75rem; font-size:1.3rem; border-radius:16px; box-shadow:4px 4px 12px rgba(0,0,0,0.08), -4px -4px 12px rgba(255,255,255,0.9); cursor:pointer; transition:all .2s ease; width:3.5rem; height:3.5rem; display:flex; justify-content:center; align-items:center; }
    .icon-btn:active { box-shadow:inset 2px 2px 6px rgba(0,0,0,0.05), inset -2px -2px 6px rgba(255,255,255,0.8); }
    .icon-btn:disabled { opacity:0.5; cursor:not-allowed; }
    .icon-btn[title] { position:relative; }
    .icon-btn[title]:hover::after { content:attr(title); position:absolute; bottom:-1.8rem; background:#444; color:#fff; font-size:.7rem; padding:2px 6px; border-radius:6px; white-space:nowrap; opacity:.9; }
  </style>
</head>
<body>
  <div id="tasks" class="pane">
    <h2>Tasks</h2>
    <div id="summary">Total: 0h 0m</div>
    <div id="schedule">
      <label>Start Time:<input type="time" id="start-time"></label><span id="finish-time"></span>
    </div>
    <form id="task-form">
      <input id="task-input" type="text" placeholder="Task e.g. 'Work 45'" required>
      <button type="submit">Add</button>
    </form>
    <ul id="task-list"></ul>
  </div>
  <div id="timer-pane" class="pane">
    <div class="mode-toggle">
      <button id="mode-timer" class="mode-btn active">Timer</button>
      <button id="mode-stopwatch" class="mode-btn">Stopwatch</button>
    </div>
    <div class="main"><div id="timer" class="timer-display">00:00</div></div>
    <div class="controls">
      <div id="timer-controls"><div class="neumorphic-input"><input id="minutesInput" type="number" placeholder="Enter minutes" min="0" step="0.1"></div></div>
      <div class="button-row">
        <button id="startBtn" class="icon-btn" title="Start">▶</button>
        <button id="pauseBtn" class="icon-btn" title="Pause" disabled>⏸</button>
        <button id="resetBtn" class="icon-btn" title="Reset">⟲</button>
      </div>
    </div>
    <audio id="endSound" src="timer-end.mp3" preload="auto"></audio>
  </div>
  <script>
    document.addEventListener('DOMContentLoaded',()=>{
      // ... Task management code unchanged ...
      // Timer & Stopwatch with timestamp-based logic
      let mode='timer';
      const modeTimerBtn=document.getElementById('mode-timer');
      const modeSwBtn=document.getElementById('mode-stopwatch');
      const timerControls=document.getElementById('timer-controls');
      const minutesInput=document.getElementById('minutesInput');
      const startBtn=document.getElementById('startBtn');
      const pauseBtn=document.getElementById('pauseBtn');
      const resetBtn=document.getElementById('resetBtn');
      const timerDisplay=document.getElementById('timer');
      const endSound=document.getElementById('endSound');
      const startTimeInput=document.getElementById('start-time');

      // Timer state
      let timerDuration=0, timerStart=0, timerPausedAt=0;
      // Stopwatch state
      let swStart=0, swElapsed=0;

      function updateTimer() {
        const now=Date.now();
        let elapsed=(now - timerStart)/1000;
        if(timerPausedAt) elapsed=(timerPausedAt - timerStart)/1000;
        let rem=Math.max(0, Math.ceil(timerDuration - elapsed));
        timerDisplay.textContent=formatTime(rem);
        if(rem<=0){ playSound(); stopTimer(); }
      }
      function startTimer(){
        const mins=parseFloat(minutesInput.value);
        if(isNaN(mins)||mins<=0){alert('Enter positive minutes');return;}
        timerDuration=mins*60;
        timerStart=Date.now();
        timerPausedAt=0;
        startBtn.disabled=true; pauseBtn.disabled=false; resetBtn.disabled=false;
        pauseBtn.textContent='⏸';
        requestAnimationFrame(timerLoop);
      }
      function timerLoop(){ updateTimer(); if(startBtn.disabled) requestAnimationFrame(timerLoop); }
      function pauseTimer(){ if(!timerPausedAt){ timerPausedAt=Date.now(); pauseBtn.textContent='▶'; } else { timerStart += (Date.now()-timerPausedAt); timerPausedAt=0; pauseBtn.textContent='⏸'; }}
      function resetTimer(){ timerStart=0; timerPausedAt=0; timerDisplay.textContent='00:00'; startBtn.disabled=false; pauseBtn.disabled=true; resetBtn.disabled=true; }

      function updateSW(){ const now=Date.now(); let elapsed=swElapsed + (now - swStart)/1000; timerDisplay.textContent=formatTime(Math.floor(elapsed)); requestAnimationFrame(swLoop); }
      function startSW(){ swStart=Date.now(); startBtn.disabled=true; pauseBtn.disabled=false; resetBtn.disabled=false; pauseBtn.textContent='⏸'; requestAnimationFrame(swLoop); }
      function swLoop(){ updateSW(); }
      function pauseSW(){ if(startBtn.disabled){ swElapsed += (Date.now()-swStart)/1000; pauseBtn.textContent='▶'; startBtn.disabled=false; } else { swStart=Date.now(); pauseBtn.textContent='⏸'; startBtn.disabled=true; requestAnimationFrame(swLoop);} }
      function resetSW(){ swStart=0; swElapsed=0; timerDisplay.textContent='00:00'; startBtn.disabled=false; pauseBtn.disabled=true; resetBtn.disabled=true; }

      function stopTimer(){ startBtn.disabled=false; pauseBtn.disabled=true; resetBtn.disabled=true; }
      function playSound(){ try{ endSound.currentTime=0; endSound.play(); }catch{} }

      function switchMode(to){ mode=to;
        modeTimerBtn.classList.toggle('active',mode==='timer');
        modeSwBtn.classList.toggle('active',mode==='stopwatch');
        timerControls.style.display = mode==='timer'?'block':'none';
        resetTimer(); resetSW();
      }
      modeTimerBtn.addEventListener('click',()=>switchMode('timer'));
      modeSwBtn.addEventListener('click',()=>switchMode('stopwatch'));
      startBtn.addEventListener('click',()=> mode==='timer'? startTimer(): startSW());
      pauseBtn.addEventListener('click',()=> mode==='timer'? pauseTimer(): pauseSW());
      resetBtn.addEventListener('click',()=> mode==='timer'? resetTimer(): resetSW());

      function formatTime(sec){ const m=String(Math.floor(sec/60)).padStart(2,'0'), s=String(sec%60).padStart(2,'0'); return `${m}:${s}`; }

      switchMode('timer');
    });
  </script>
</body>
</html>
